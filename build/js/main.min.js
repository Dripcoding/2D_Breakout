!function(){"use strict";var o=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},s=function(){function n(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(t,e,i){return e&&n(t.prototype,e),i&&n(t,i),t}}(),t=function(){function t(){o(this,t),this.canvas=document.getElementById("myCanvas"),this.ctx=this.canvas.getContext("2d"),this.width=this.canvas.width,this.height=this.canvas.height}return s(t,[{key:"clear",value:function(){this.ctx.clearRect(0,0,this.width,this.height)}},{key:"detectEdgeCollisions",value:function(t,e,i){t.y+t.dy<t.ballRadius?(t.dy=-t.dy,t.changeColor()):t.y+t.dy>this.height-t.ballRadius&&(t.x>e.paddleX&&t.x<e.paddleX+e.paddleWidth?(t.dy=-t.dy,t.changeColor()):(i.lives--,0===i.lives?(alert("Game Over"),document.location.reload()):(t.x=this.width/2,t.y=this.height-30,e.paddleX=(this.width-e.paddleWidth)/2))),(t.x+t.dx<t.ballRadius||t.x+t.dx>this.width-t.ballRadius)&&(t.dx=-t.dx,t.changeColor())}},{key:"detectBrickCollisions",value:function(t,e,i){for(var n=0;n<e.brickColumnCount;n++)for(var o=0;o<e.brickRowCount;o++){var s=e.bricks[n][o];1===s.status&&t.x>s.x&&t.x<s.x+e.brickWidth&&t.y>s.y&&t.y<s.y+e.brickHeight&&(t.dy=-t.dy,t.changeColor(),s.status=0,i.score++,i.score==e.brickRowCount*e.brickColumnCount&&(alert("You Win! Congrats!"),document.location.reload()))}}}]),t}(),i=function(){function n(t,e,i){o(this,n),this.ballColor="#0095DD",this.x=e/2,this.y=t-30,this.ballRadius=10,this.dx=i.dx,this.dy=i.dy}return s(n,[{key:"changeColor",value:function(){var t="rgb("+256*Math.random()+", "+256*Math.random()+", "+256*Math.random()+")";this.ballColor=t}},{key:"drawBall",value:function(t){t.ctx.beginPath(),t.ctx.arc(this.x,this.y,this.ballRadius,0,2*Math.PI),t.ctx.fillStyle=this.ballColor,t.ctx.fill(),t.ctx.closePath()}},{key:"update",value:function(){this.x+=this.dx,this.y+=this.dy}}]),n}(),n=function(){function i(){o(this,i),this.brickColor="#0095DD",this.brickRowCount=10,this.brickColumnCount=7,this.brickWidth=75,this.brickHeight=20,this.brickPadding=10,this.brickOffsetTop=50,this.brickOffsetLeft=160,this.bricks=[];for(var t=0;t<this.brickColumnCount;t++){this.bricks[t]=[];for(var e=0;e<this.brickRowCount;e++)this.bricks[t][e]={x:0,y:0,status:1}}}return s(i,[{key:"drawBricks",value:function(t){for(var e=0;e<this.brickColumnCount;e++)for(var i=0;i<this.brickRowCount;i++){var n=this.bricks[e][i];if(1===n.status){var o=e*(this.brickWidth+this.brickPadding)+this.brickOffsetLeft,s=i*(this.brickHeight+this.brickPadding)+this.brickOffsetTop;n.x=o,n.y=s,t.ctx.beginPath(),t.ctx.rect(n.x,n.y,this.brickWidth,this.brickHeight),t.ctx.fillStyle=this.brickColor,t.ctx.fill(),t.ctx.closePath()}}}}]),i}(),e=function(){function e(t){o(this,e),this.paddleColor="#0095DD",this.paddleHeight=10,this.paddleWidth=75,this.paddleX=(t.width-this.paddleWidth)/2}return s(e,[{key:"drawPaddle",value:function(t){t.ctx.beginPath(),t.ctx.rect(this.paddleX,t.height-this.paddleHeight,this.paddleWidth,this.paddleHeight),t.ctx.fillStyle=this.paddleColor,t.ctx.fill(),t.ctx.closePath()}},{key:"update",value:function(t){this.paddleX+=t}}]),e}(),a=function(){function e(t){o(this,e),this.lives=t.lives,this.score=0,this.opponentScore=0,this.opponentLives=0,this.x=0,this.y=0}return s(e,[{key:"drawScore",value:function(t){t.ctx.font="24px Arial",t.ctx.fillStyle="#0095DD",t.ctx.fillText("Score: "+this.score,8,20),t.ctx.fillText("Opponent's Score: "+this.opponentScore,8,40)}},{key:"drawLives",value:function(t){t.ctx.font="24px Arial",t.ctx.fillStyle="#0095DD",t.ctx.fillText("Lives: "+this.lives,t.width-90,20),t.ctx.fillText("Opponent's Lives: "+this.opponentLives,t.width-218,40)}},{key:"update",value:function(t,e,i){this.lives+=t,this.username=e,this.score+=i}}]),e}(),r=io.connect("https://breakout-2d.herokuapp.com");document.write('<script src="https://'+(location.host||"localhost").split(":")[0]+':35729/livereload.js?snipver=1"><\/script>');var d=function(){function t(){o(this,t),this.rightPressed=!1,this.leftPressed=!1,this.players=[],window.addEventListener("keydown",this.keyDownHandler,!1),window.addEventListener("keyup",this.keyUpHandler,!1),window.addEventListener("mousemove",this.mouseMoveHandler,!1),h.addEventListener("click",v,!1),u.addEventListener("click",v,!1),y.addEventListener("click",v,!1),f.addEventListener("click",v,!1)}return s(t,[{key:"init",value:function(){var t=this;requestAnimationFrame(function(){return t.draw(k)})}},{key:"draw",value:function(t){var e=this;console.log("MODE "+c.name),t.clear(),t.ctx.beginPath(),x.drawPaddle(t),m.drawBricks(t),p.drawBall(t),b.drawScore(t),b.drawLives(t),t.detectBrickCollisions(p,m,b),t.detectEdgeCollisions(p,x,b),r.emit("playerScored",b),r.emit("playerLife",b),this.rightPressed&&x.paddleX<t.width-x.paddleWidth?x.update(7):this.leftPressed&&0<x.paddleX&&x.update(-7),p.update(),!1===l&&requestAnimationFrame(function(){e.draw(t)})}},{key:"keyDownHandler",value:function(t){39===t.keyCode?w.rightPressed=!0:37===t.keyCode?w.leftPressed=!0:80===t.keyCode?!1===(l=!l)&&w.init():81===t.keyCode&&(console.log("player quit game"),alert("You quit. Game Over!"),document.location.reload())}},{key:"keyUpHandler",value:function(t){39===t.keyCode?w.rightPressed=!1:37===t.keyCode&&(w.leftPressed=!1)}},{key:"mouseMoveHandler",value:function(t){var e=t.clientX-k.canvas.offsetLeft;0<e&&e<k.width&&(x.paddleX=e-x.paddleWidth/2)}}]),t}(),l=!0,c={name:"very easy",dx:1.5,dy:-1.5,lives:5},h=document.querySelector(".easy-mode-btn"),u=document.querySelector(".medium-mode-btn"),y=document.querySelector(".hard-mode-btn"),f=document.querySelector(".marathon-mode-btn");function v(t){var e=t.target.name;"easy"===e?(c={name:"easy",dx:2,dy:-2,lives:3},console.log("mode changed to easy",c)):"medium"===e?(c={name:"medium",dx:3,dy:-3,lives:3},console.log("mode changed to medium",c)):"hard"===e?(c={name:"hard",dx:4,dy:-4,lives:2},console.log("mode changed to hard",c)):(c={name:"marathon",dx:5,dy:-5,lives:2},console.log("mode changed to marathon",c)),p=new i(k.height,k.width,c),b=new a(c),m=new n(k)}var k=new t,p=new i(k.height,k.width,c),m=new n(k),x=new e(k),b=new a(c),w=new d;r.on("otherPlayerScore",function(t){b.opponentScore=t}),r.on("otherPlayerLife",function(t){b.opponentLives=t}),w.init()}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWFpbi5taW4uanMiLCJzb3VyY2VzIjpbIi4uLy4uL3B1YmxpYy9qcy9tb2R1bGVzL2NhbnZhcy5qcyIsIi4uLy4uL3B1YmxpYy9qcy9tb2R1bGVzL2JhbGwuanMiLCIuLi8uLi9wdWJsaWMvanMvbW9kdWxlcy9icmljay5qcyIsIi4uLy4uL3B1YmxpYy9qcy9tb2R1bGVzL3BhZGRsZS5qcyIsIi4uLy4uL3B1YmxpYy9qcy9tb2R1bGVzL3BsYXllci5qcyIsIi4uLy4uL3B1YmxpYy9qcy9tb2R1bGVzL2NsaWVudC5qcyIsIi4uLy4uL3B1YmxpYy9qcy9nYW1lLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImNsYXNzIENhbnZhcyB7XG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIHRoaXMuY2FudmFzID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJteUNhbnZhc1wiKTtcbiAgICAgICAgdGhpcy5jdHggPSB0aGlzLmNhbnZhcy5nZXRDb250ZXh0KFwiMmRcIik7XG4gICAgICAgIHRoaXMud2lkdGggPSB0aGlzLmNhbnZhcy53aWR0aDtcbiAgICAgICAgdGhpcy5oZWlnaHQgPSB0aGlzLmNhbnZhcy5oZWlnaHQ7XG4gICAgfVxuXG4gICAgY2xlYXIoKSB7XG4gICAgICAgIHRoaXMuY3R4LmNsZWFyUmVjdCgwLCAwLCB0aGlzLndpZHRoLCB0aGlzLmhlaWdodCk7XG4gICAgfVxuXG4gICAgLy8gZGV0ZWN0IGNvbGxpc2lvbnMgYWdhaW5zdCBjYW52YXMgZWRnZXNcbiAgICBkZXRlY3RFZGdlQ29sbGlzaW9ucyhiYWxsLCBwYWRkbGUsIHBsYXllcikge1xuICAgICAgICAvLyBkZXRlY3QgY29sbGlzaW9ucyB3aXRoIHRvcCBlZGdlXG4gICAgICAgIGlmIChiYWxsLnkgKyBiYWxsLmR5IDwgYmFsbC5iYWxsUmFkaXVzKSB7XG4gICAgICAgICAgICBiYWxsLmR5ID0gLWJhbGwuZHk7XG4gICAgICAgICAgICBiYWxsLmNoYW5nZUNvbG9yKCk7XG4gICAgICAgIH0gZWxzZSBpZiAoYmFsbC55ICsgYmFsbC5keSA+IHRoaXMuaGVpZ2h0IC0gYmFsbC5iYWxsUmFkaXVzKSB7XG4gICAgICAgICAgICBpZiAoXG4gICAgICAgICAgICAgICAgYmFsbC54ID4gcGFkZGxlLnBhZGRsZVggJiZcbiAgICAgICAgICAgICAgICBiYWxsLnggPCBwYWRkbGUucGFkZGxlWCArIHBhZGRsZS5wYWRkbGVXaWR0aFxuICAgICAgICAgICAgKSB7XG4gICAgICAgICAgICAgICAgLy8gYmFsbCBjb2xsaWRlcyB3aXRoIHRoZSBwYWRkbGVcbiAgICAgICAgICAgICAgICBiYWxsLmR5ID0gLWJhbGwuZHk7XG4gICAgICAgICAgICAgICAgYmFsbC5jaGFuZ2VDb2xvcigpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBwbGF5ZXIubGl2ZXMtLTtcbiAgICAgICAgICAgICAgICBpZiAocGxheWVyLmxpdmVzID09PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgIGFsZXJ0KFwiR2FtZSBPdmVyXCIpO1xuICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC5sb2NhdGlvbi5yZWxvYWQoKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBiYWxsLnggPSB0aGlzLndpZHRoIC8gMjtcbiAgICAgICAgICAgICAgICAgICAgYmFsbC55ID0gdGhpcy5oZWlnaHQgLSAzMDtcbiAgICAgICAgICAgICAgICAgICAgcGFkZGxlLnBhZGRsZVggPSAodGhpcy53aWR0aCAtIHBhZGRsZS5wYWRkbGVXaWR0aCkgLyAyO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICAvLyBkZXRlY3QgY29sbGlzaW9uIHdpdGggbGVmdCBhbmQgcmlnaHQgZWRnZXNcbiAgICAgICAgaWYgKFxuICAgICAgICAgICAgYmFsbC54ICsgYmFsbC5keCA8IGJhbGwuYmFsbFJhZGl1cyB8fFxuICAgICAgICAgICAgYmFsbC54ICsgYmFsbC5keCA+IHRoaXMud2lkdGggLSBiYWxsLmJhbGxSYWRpdXNcbiAgICAgICAgKSB7XG4gICAgICAgICAgICBiYWxsLmR4ID0gLWJhbGwuZHg7XG4gICAgICAgICAgICBiYWxsLmNoYW5nZUNvbG9yKCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBkZXRlY3RCcmlja0NvbGxpc2lvbnMoYmFsbCwgYnJpY2ssIHBsYXllcikge1xuICAgICAgICAvLyBjb21wYXJlIHBvc2l0aW9uIG9mIGJyaWNrcyB3aXRoIHRoZSBiYWxsIGZvciBldmVyeSBmcmFtZVxuICAgICAgICBmb3IgKGxldCBjb2wgPSAwOyBjb2wgPCBicmljay5icmlja0NvbHVtbkNvdW50OyBjb2wrKykge1xuICAgICAgICAgICAgZm9yIChsZXQgcm93ID0gMDsgcm93IDwgYnJpY2suYnJpY2tSb3dDb3VudDsgcm93KyspIHtcbiAgICAgICAgICAgICAgICBsZXQgYiA9IGJyaWNrLmJyaWNrc1tjb2xdW3Jvd107XG5cbiAgICAgICAgICAgICAgICBpZiAoYi5zdGF0dXMgPT09IDEpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gYSBjb2xsaXNpb24gd2l0aCBhIGJyaWNrIG9jY3VycyB3aGVuIHRoZSBjZW50ZXIgb2YgdGhlIGJhbGwgaXMgaW5zaWRlIGEgYnJpY2sncyBjb29yZGluYXRlc1xuICAgICAgICAgICAgICAgICAgICAvLyBpZiBhIGNvbGxpc2lvbiBvY2N1cnMsIGNoYW5nZSB0aGUgbW92ZW1lbnQgb2YgdGhlIGJhbGwsIGEgYnJpY2sncyBzdGF0dXMsIHNjb3JlXG4gICAgICAgICAgICAgICAgICAgIGlmIChcbiAgICAgICAgICAgICAgICAgICAgICAgIGJhbGwueCA+IGIueCAmJiAvLyB4IHBvc2l0aW9uIG9mIHRoZSBiYWxsIGlzIGdyZWF0ZXIgdGhhbiB0aGUgeCBwb3NpdGlvbiBvZiB0aGUgYnJpY2tcbiAgICAgICAgICAgICAgICAgICAgICAgIGJhbGwueCA8IGIueCArIGJyaWNrLmJyaWNrV2lkdGggJiYgLy8geCBwb3NpdGlvbiBvZiB0aGUgYmFsbCBpcyBsZXNzIHRoYW4gdGhlIHggcG9zaXRpb24gb2YgdGhlIGJyaWNrIHBsdXMgaXRzIHdpZHRoXG4gICAgICAgICAgICAgICAgICAgICAgICBiYWxsLnkgPiBiLnkgJiYgLy8geSBwb3NpdGlvbiBvZiB0aGUgYmFsbCBpcyBncmVhdGVyIHRoYW4gdGhlIHkgcG9zaXRpb24gb2YgdGhlIGJyaWNrXG4gICAgICAgICAgICAgICAgICAgICAgICBiYWxsLnkgPCBiLnkgKyBicmljay5icmlja0hlaWdodCAvLyB5IHBvc2l0aW9uIG9mIHRoZSBiYWxsIGlzIGxlc3MgdGhhbiB0aGUgeSBwb3NpdGlvbiBvZiB0aGUgYnJpY2sgcGx1cyBpdHMgaGVpZ2h0XG4gICAgICAgICAgICAgICAgICAgICkge1xuICAgICAgICAgICAgICAgICAgICAgICAgYmFsbC5keSA9IC1iYWxsLmR5O1xuICAgICAgICAgICAgICAgICAgICAgICAgYmFsbC5jaGFuZ2VDb2xvcigpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYi5zdGF0dXMgPSAwO1xuICAgICAgICAgICAgICAgICAgICAgICAgcGxheWVyLnNjb3JlKys7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGxheWVyLnNjb3JlID09XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJpY2suYnJpY2tSb3dDb3VudCAqIGJyaWNrLmJyaWNrQ29sdW1uQ291bnRcbiAgICAgICAgICAgICAgICAgICAgICAgICkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGRpc3BsYXkgd2lubmluZyBtc2cgd2hlbiBzY29yZSBpcyBlcXVhbCB0byB0aGUgbnVtYmVyIG9mIGJyaWNrc1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFsZXJ0KFwiWW91IFdpbiEgQ29uZ3JhdHMhXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LmxvY2F0aW9uLnJlbG9hZCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxufVxuXG5leHBvcnQgZGVmYXVsdCBDYW52YXM7XG4iLCJjbGFzcyBCYWxsIHtcbiAgICBjb25zdHJ1Y3RvcihoZWlnaHQsIHdpZHRoLCBtb2RlKSB7XG4gICAgICAgIHRoaXMuYmFsbENvbG9yID0gXCIjMDA5NUREXCI7XG4gICAgICAgIC8vIHN0YXJ0aW5nIHBvc2l0aW9uXG4gICAgICAgIHRoaXMueCA9IHdpZHRoIC8gMjtcbiAgICAgICAgdGhpcy55ID0gaGVpZ2h0IC0gMzA7XG4gICAgICAgIHRoaXMuYmFsbFJhZGl1cyA9IDEwO1xuICAgICAgICAvLyB2ZWxvY2l0eSAtIGNoYW5nZSBpbiBwb3NpdGlvblxuICAgICAgICB0aGlzLmR4ID0gbW9kZS5keDtcbiAgICAgICAgdGhpcy5keSA9IG1vZGUuZHk7XG4gICAgfVxuXG4gICAgY2hhbmdlQ29sb3IoKSB7XG4gICAgICAgIGNvbnN0IHJlZCA9IE1hdGgucmFuZG9tKCkgKiAyNTY7XG4gICAgICAgIGNvbnN0IGdyZWVuID0gTWF0aC5yYW5kb20oKSAqIDI1NjtcbiAgICAgICAgY29uc3QgYmx1ZSA9IE1hdGgucmFuZG9tKCkgKiAyNTY7XG4gICAgICAgIGNvbnN0IGNvbG9yID0gYHJnYigke3JlZH0sICR7Z3JlZW59LCAke2JsdWV9KWA7XG4gICAgICAgIHRoaXMuYmFsbENvbG9yID0gY29sb3I7XG4gICAgfVxuXG4gICAgLy8gZHJhdyBiYWxsIHRvIHRoZSBjYW52YXNcbiAgICBkcmF3QmFsbChjYW52YXMpIHtcbiAgICAgICAgY2FudmFzLmN0eC5iZWdpblBhdGgoKTtcbiAgICAgICAgY2FudmFzLmN0eC5hcmModGhpcy54LCB0aGlzLnksIHRoaXMuYmFsbFJhZGl1cywgMCwgTWF0aC5QSSAqIDIpO1xuICAgICAgICBjYW52YXMuY3R4LmZpbGxTdHlsZSA9IHRoaXMuYmFsbENvbG9yO1xuICAgICAgICBjYW52YXMuY3R4LmZpbGwoKTtcbiAgICAgICAgY2FudmFzLmN0eC5jbG9zZVBhdGgoKTtcbiAgICB9XG5cbiAgICAvLyB1cGRhdGUgYmFsbCdzIG1vdmVtZW50XG4gICAgdXBkYXRlKCkge1xuICAgICAgICB0aGlzLnggKz0gdGhpcy5keDtcbiAgICAgICAgdGhpcy55ICs9IHRoaXMuZHk7XG4gICAgfVxufVxuXG5leHBvcnQgZGVmYXVsdCBCYWxsO1xuIiwiY2xhc3MgQnJpY2sge1xuXHRjb25zdHJ1Y3RvcigpIHtcblx0XHQvLyBicmljayBwcm9wZXJ0aWVzXG5cdFx0dGhpcy5icmlja0NvbG9yID0gXCIjMDA5NUREXCI7XG5cdFx0dGhpcy5icmlja1Jvd0NvdW50ID0gMTA7XG5cdFx0dGhpcy5icmlja0NvbHVtbkNvdW50ID0gNztcblx0XHR0aGlzLmJyaWNrV2lkdGggPSA3NTtcblx0XHR0aGlzLmJyaWNrSGVpZ2h0ID0gMjA7XG5cdFx0dGhpcy5icmlja1BhZGRpbmcgPSAxMDtcblx0XHR0aGlzLmJyaWNrT2Zmc2V0VG9wID0gNTA7XG5cdFx0dGhpcy5icmlja09mZnNldExlZnQgPSAxNjA7XG5cdFx0Ly8gaW5pdGlhbGl6ZSBicmlja3Ncblx0XHR0aGlzLmJyaWNrcyA9IFtdO1xuXG5cdFx0Zm9yIChsZXQgY29sID0gMDsgY29sIDwgdGhpcy5icmlja0NvbHVtbkNvdW50OyBjb2wrKykge1xuXHRcdFx0dGhpcy5icmlja3NbY29sXSA9IFtdO1xuXHRcdFx0Zm9yIChsZXQgcm93ID0gMDsgcm93IDwgdGhpcy5icmlja1Jvd0NvdW50OyByb3crKykge1xuXHRcdFx0XHR0aGlzLmJyaWNrc1tjb2xdW3Jvd10gPSB7IHg6IDAsIHk6IDAsIHN0YXR1czogMSB9OyAvLyBkZWZhdWx0IGJyaWNrIHByb3BlcnRpZXNcblx0XHRcdH1cblx0XHR9XG5cdH1cblxuXHQvLyBkcmF3IGJyaWNrIGdyaWQgdG8gdGhlIGNhbnZhc1xuXHRkcmF3QnJpY2tzKGNhbnZhcykge1xuXHRcdGZvciAobGV0IGNvbCA9IDA7IGNvbCA8IHRoaXMuYnJpY2tDb2x1bW5Db3VudDsgY29sKyspIHtcblx0XHRcdGZvciAobGV0IHJvdyA9IDA7IHJvdyA8IHRoaXMuYnJpY2tSb3dDb3VudDsgcm93KyspIHtcblx0XHRcdFx0bGV0IGJyaWNrID0gdGhpcy5icmlja3NbY29sXVtyb3ddO1xuXHRcdFx0XHRpZiAoYnJpY2suc3RhdHVzID09PSAxKSB7XG5cdFx0XHRcdFx0Ly8gYmFsbCBkaWQgbm90IGNvbGxpZGUgd2l0aCBicmlja1xuXHRcdFx0XHRcdGxldCBicmlja1ggPVxuXHRcdFx0XHRcdFx0Y29sICogKHRoaXMuYnJpY2tXaWR0aCArIHRoaXMuYnJpY2tQYWRkaW5nKSArIHRoaXMuYnJpY2tPZmZzZXRMZWZ0OyAvLyBvZmZzZXQgWCBwb3NpdGlvbiBmcm9tIHByZXZpb3VzIGJyaWNrXG5cdFx0XHRcdFx0bGV0IGJyaWNrWSA9XG5cdFx0XHRcdFx0XHRyb3cgKiAodGhpcy5icmlja0hlaWdodCArIHRoaXMuYnJpY2tQYWRkaW5nKSArIHRoaXMuYnJpY2tPZmZzZXRUb3A7IC8vIG9mZnNldCBZIHBvc2l0aW9uIGZyb20gcHJldmlvdXMgYnJpY2tcblx0XHRcdFx0XHRicmljay54ID0gYnJpY2tYO1xuXHRcdFx0XHRcdGJyaWNrLnkgPSBicmlja1k7XG5cdFx0XHRcdFx0Y2FudmFzLmN0eC5iZWdpblBhdGgoKTtcblx0XHRcdFx0XHRjYW52YXMuY3R4LnJlY3QoYnJpY2sueCwgYnJpY2sueSwgdGhpcy5icmlja1dpZHRoLCB0aGlzLmJyaWNrSGVpZ2h0KTtcblx0XHRcdFx0XHRjYW52YXMuY3R4LmZpbGxTdHlsZSA9IHRoaXMuYnJpY2tDb2xvcjtcblx0XHRcdFx0XHRjYW52YXMuY3R4LmZpbGwoKTtcblx0XHRcdFx0XHRjYW52YXMuY3R4LmNsb3NlUGF0aCgpO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fVxuXHR9XG59XG5cbmV4cG9ydCBkZWZhdWx0IEJyaWNrO1xuIiwiY2xhc3MgUGFkZGxlIHtcblx0Y29uc3RydWN0b3IoY2FudmFzKSB7XG5cdFx0Ly8gcGFkZGxlIHByb3BlcnRpZXNcblx0XHR0aGlzLnBhZGRsZUNvbG9yID0gXCIjMDA5NUREXCI7XG5cdFx0dGhpcy5wYWRkbGVIZWlnaHQgPSAxMDtcblx0XHR0aGlzLnBhZGRsZVdpZHRoID0gNzU7XG5cdFx0Ly8gc3RhcnRpbmcgcG9zaXRpb25cblx0XHR0aGlzLnBhZGRsZVggPSAoY2FudmFzLndpZHRoIC0gdGhpcy5wYWRkbGVXaWR0aCkgLyAyO1xuXHR9XG5cblx0Ly8gZHJhdyBwYWRkbGUgdG8gdGhlIGNhbnZhc1xuXHRkcmF3UGFkZGxlKGNhbnZhcykge1xuXHRcdGNhbnZhcy5jdHguYmVnaW5QYXRoKCk7XG5cdFx0Y2FudmFzLmN0eC5yZWN0KFxuXHRcdFx0dGhpcy5wYWRkbGVYLFxuXHRcdFx0Y2FudmFzLmhlaWdodCAtIHRoaXMucGFkZGxlSGVpZ2h0LFxuXHRcdFx0dGhpcy5wYWRkbGVXaWR0aCxcblx0XHRcdHRoaXMucGFkZGxlSGVpZ2h0XG5cdFx0KTtcblx0XHRjYW52YXMuY3R4LmZpbGxTdHlsZSA9IHRoaXMucGFkZGxlQ29sb3I7XG5cdFx0Y2FudmFzLmN0eC5maWxsKCk7XG5cdFx0Y2FudmFzLmN0eC5jbG9zZVBhdGgoKTtcblx0fVxuXG5cdC8vIHVwZGF0ZSBwYWRkbGUgcG9zaXRpb25cblx0dXBkYXRlKHgpIHtcblx0XHR0aGlzLnBhZGRsZVggKz0geDtcblx0fVxufVxuXG5leHBvcnQgZGVmYXVsdCBQYWRkbGU7XG4iLCJjbGFzcyBQbGF5ZXIge1xuICAgIGNvbnN0cnVjdG9yKG1vZGUpIHtcbiAgICAgICAgdGhpcy5saXZlcyA9IG1vZGUubGl2ZXM7XG4gICAgICAgIHRoaXMuc2NvcmUgPSAwO1xuICAgICAgICB0aGlzLm9wcG9uZW50U2NvcmUgPSAwO1xuICAgICAgICB0aGlzLm9wcG9uZW50TGl2ZXMgPSAwO1xuICAgICAgICB0aGlzLnggPSAwO1xuICAgICAgICB0aGlzLnkgPSAwO1xuICAgIH1cblxuICAgIC8vIGRyYXcgY3VycmVudCBzY29yZSB0byB0aGUgY2FudmFzXG4gICAgZHJhd1Njb3JlKGNhbnZhcykge1xuICAgICAgICBjYW52YXMuY3R4LmZvbnQgPSBcIjI0cHggQXJpYWxcIjtcbiAgICAgICAgY2FudmFzLmN0eC5maWxsU3R5bGUgPSBcIiMwMDk1RERcIjtcbiAgICAgICAgY2FudmFzLmN0eC5maWxsVGV4dChcIlNjb3JlOiBcIiArIHRoaXMuc2NvcmUsIDgsIDIwKTtcbiAgICAgICAgY2FudmFzLmN0eC5maWxsVGV4dChcIk9wcG9uZW50J3MgU2NvcmU6IFwiICsgdGhpcy5vcHBvbmVudFNjb3JlLCA4LCA0MCk7XG4gICAgfVxuXG4gICAgLy8gZHJhdyBjdXJyZW50IG51bWJlciBvZiBsaXZlcyB0byB0aGUgY2FudmFzXG4gICAgZHJhd0xpdmVzKGNhbnZhcykge1xuICAgICAgICBjYW52YXMuY3R4LmZvbnQgPSBcIjI0cHggQXJpYWxcIjtcbiAgICAgICAgY2FudmFzLmN0eC5maWxsU3R5bGUgPSBcIiMwMDk1RERcIjtcbiAgICAgICAgY2FudmFzLmN0eC5maWxsVGV4dChcIkxpdmVzOiBcIiArIHRoaXMubGl2ZXMsIGNhbnZhcy53aWR0aCAtIDkwLCAyMCk7XG4gICAgICAgIGNhbnZhcy5jdHguZmlsbFRleHQoXG4gICAgICAgICAgICBcIk9wcG9uZW50J3MgTGl2ZXM6IFwiICsgdGhpcy5vcHBvbmVudExpdmVzLFxuICAgICAgICAgICAgY2FudmFzLndpZHRoIC0gMjE4LFxuICAgICAgICAgICAgNDBcbiAgICAgICAgKTtcbiAgICB9XG5cbiAgICAvLyB1ZHBhdGUgcGxheWVyIGRhdGFcbiAgICB1cGRhdGUobGl2ZXMsIHVzZXJuYW1lLCBzY29yZSkge1xuICAgICAgICB0aGlzLmxpdmVzICs9IGxpdmVzO1xuICAgICAgICB0aGlzLnVzZXJuYW1lID0gdXNlcm5hbWU7XG4gICAgICAgIHRoaXMuc2NvcmUgKz0gc2NvcmU7XG4gICAgfVxufVxuXG5leHBvcnQgZGVmYXVsdCBQbGF5ZXI7XG4iLCJjb25zdCBzb2NrZXQgPSBpby5jb25uZWN0KFwiaHR0cHM6Ly9icmVha291dC0yZC5oZXJva3VhcHAuY29tXCIpOyAvLyBpbnN0YXRpYXRlIGNvbm5lY3Rpb24gdG8gc2VydmVyIC0gbG9jYWwgaG9zdFxuXG5leHBvcnQgZGVmYXVsdCBzb2NrZXQ7XG4iLCIvLyBtb2R1bGVzXG5pbXBvcnQgQ2FudmFzIGZyb20gXCIuL21vZHVsZXMvY2FudmFzXCI7XG5pbXBvcnQgQmFsbCBmcm9tIFwiLi9tb2R1bGVzL2JhbGxcIjtcbmltcG9ydCBCcmljayBmcm9tIFwiLi9tb2R1bGVzL2JyaWNrXCI7XG5pbXBvcnQgUGFkZGxlIGZyb20gXCIuL21vZHVsZXMvcGFkZGxlXCI7XG5pbXBvcnQgUGxheWVyIGZyb20gXCIuL21vZHVsZXMvcGxheWVyXCI7XG5pbXBvcnQgc29ja2V0IGZyb20gXCIuL21vZHVsZXMvY2xpZW50XCI7XG5cbi8vIGVuYWJsZSBsaXZlIHJlbG9hZFxuZG9jdW1lbnQud3JpdGUoXG4gICAgJzxzY3JpcHQgc3JjPVwiaHR0cHM6Ly8nICtcbiAgICAgICAgKGxvY2F0aW9uLmhvc3QgfHwgXCJsb2NhbGhvc3RcIikuc3BsaXQoXCI6XCIpWzBdICtcbiAgICAgICAgJzozNTcyOS9saXZlcmVsb2FkLmpzP3NuaXB2ZXI9MVwiPjwvJyArXG4gICAgICAgIFwic2NyaXB0PlwiXG4pO1xuXG5jbGFzcyBHYW1lIHtcbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgdGhpcy5yaWdodFByZXNzZWQgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5sZWZ0UHJlc3NlZCA9IGZhbHNlO1xuICAgICAgICB0aGlzLnBsYXllcnMgPSBbXTsgLy8gaG9sZHMgYWxsIHBsYXllcnMgaW4gdGhlIGdhbWVcblxuICAgICAgICAvLyBsaXN0ZW4gZm9yIGtleSBwcmVzcyBhbmQga2V5IHJlbGVhc2VcbiAgICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIHRoaXMua2V5RG93bkhhbmRsZXIsIGZhbHNlKTtcbiAgICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXl1cFwiLCB0aGlzLmtleVVwSGFuZGxlciwgZmFsc2UpO1xuICAgICAgICAvLyBsaXN0ZW4gZm9yIG1vdXNlIG1vdmVtZW50XG4gICAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwibW91c2Vtb3ZlXCIsIHRoaXMubW91c2VNb3ZlSGFuZGxlciwgZmFsc2UpO1xuICAgICAgICAvLyBsaXN0ZW4gZm9yIGNoYW5nZXMgaW4gZ2FtZSBtb2RlXG4gICAgICAgIGVhc3lNb2RlLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBzZWxlY3RHYW1lTW9kZSwgZmFsc2UpO1xuICAgICAgICBtZWRpdW1Nb2RlLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBzZWxlY3RHYW1lTW9kZSwgZmFsc2UpO1xuICAgICAgICBoYXJkTW9kZS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgc2VsZWN0R2FtZU1vZGUsIGZhbHNlKTtcbiAgICAgICAgbWFyYXRob25Nb2RlLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBzZWxlY3RHYW1lTW9kZSwgZmFsc2UpO1xuICAgIH1cblxuICAgIC8vIGluaXRpYWxpemUgdGhlIGdhbWUgb2JqZWN0cyBhbmQgdGhlIGdhbWUgbG9vcFxuICAgIGluaXQoKSB7XG4gICAgICAgIHJlcXVlc3RBbmltYXRpb25GcmFtZSgoKSA9PiB0aGlzLmRyYXcoY2FudmFzKSk7XG4gICAgfVxuXG4gICAgLy8gbWFpbiBkcmF3IGZ1bmN0aW9uIG9mIHRoZSBnYW1lIC0gaW5pdGlhdGVzIGdhbWUgbG9vcCAtIFdPUksgSU4gUFJPR1JFU1NcbiAgICBkcmF3KGNhbnZhcykge1xuICAgICAgICBjb25zb2xlLmxvZyhgTU9ERSAke21vZGUubmFtZX1gKTtcbiAgICAgICAgLy8gY2xlYXIgcHJldmlvdXMgYmFsbCBiZWZvcmUgZHJhd2luZyBhIG5ldyBvbmVcbiAgICAgICAgY2FudmFzLmNsZWFyKCk7XG4gICAgICAgIGNhbnZhcy5jdHguYmVnaW5QYXRoKCk7XG4gICAgICAgIHBhZGRsZS5kcmF3UGFkZGxlKGNhbnZhcyk7XG4gICAgICAgIGJyaWNrLmRyYXdCcmlja3MoY2FudmFzKTtcbiAgICAgICAgYmFsbC5kcmF3QmFsbChjYW52YXMpO1xuICAgICAgICBwbGF5ZXIuZHJhd1Njb3JlKGNhbnZhcyk7XG4gICAgICAgIHBsYXllci5kcmF3TGl2ZXMoY2FudmFzKTtcbiAgICAgICAgY2FudmFzLmRldGVjdEJyaWNrQ29sbGlzaW9ucyhiYWxsLCBicmljaywgcGxheWVyKTtcbiAgICAgICAgY2FudmFzLmRldGVjdEVkZ2VDb2xsaXNpb25zKGJhbGwsIHBhZGRsZSwgcGxheWVyKTtcblxuICAgICAgICBzb2NrZXQuZW1pdChcInBsYXllclNjb3JlZFwiLCBwbGF5ZXIpOyAvLyBzZW5kIHBsYXllciBkYXRhIHRvIHNlcnZlclxuICAgICAgICBzb2NrZXQuZW1pdChcInBsYXllckxpZmVcIiwgcGxheWVyKTtcblxuICAgICAgICAvLyBtb3ZlIHBhZGRsZSByaWdodCB1bnRpbCB0aGUgcmlnaHQgZWRnZSBvZiB0aGUgY2FudmFzXG4gICAgICAgIGlmIChcbiAgICAgICAgICAgIHRoaXMucmlnaHRQcmVzc2VkICYmXG4gICAgICAgICAgICBwYWRkbGUucGFkZGxlWCA8IGNhbnZhcy53aWR0aCAtIHBhZGRsZS5wYWRkbGVXaWR0aFxuICAgICAgICApIHtcbiAgICAgICAgICAgIHBhZGRsZS51cGRhdGUoNyk7XG4gICAgICAgIH0gZWxzZSBpZiAodGhpcy5sZWZ0UHJlc3NlZCAmJiBwYWRkbGUucGFkZGxlWCA+IDApIHtcbiAgICAgICAgICAgIHBhZGRsZS51cGRhdGUoLTcpO1xuICAgICAgICB9XG4gICAgICAgIC8vIHVwZGF0ZSBiYWxsJ3MgcG9zaXRpb25cbiAgICAgICAgYmFsbC51cGRhdGUoKTtcblxuICAgICAgICBpZiAocGF1c2UgPT09IGZhbHNlKSB7XG4gICAgICAgICAgICAvLyBhbmltYXRpb24gbG9vcHNcbiAgICAgICAgICAgIHJlcXVlc3RBbmltYXRpb25GcmFtZSgoKSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5kcmF3KGNhbnZhcyk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8vIGNoZWNrIGlmIGEga2V5IHdhcyBwcmVzc2VkXG4gICAga2V5RG93bkhhbmRsZXIoZSkge1xuICAgICAgICBpZiAoZS5rZXlDb2RlID09PSAzOSkge1xuICAgICAgICAgICAgLy8gcmlnaHQgY3Vyc29yIGtleSBwcmVzc2VkXG4gICAgICAgICAgICBnLnJpZ2h0UHJlc3NlZCA9IHRydWU7XG4gICAgICAgIH0gZWxzZSBpZiAoZS5rZXlDb2RlID09PSAzNykge1xuICAgICAgICAgICAgLy8gbGVmdCBjdXJzb3Iga2V5IHByZXNzZWRcbiAgICAgICAgICAgIGcubGVmdFByZXNzZWQgPSB0cnVlO1xuICAgICAgICB9IGVsc2UgaWYgKGUua2V5Q29kZSA9PT0gODApIHtcbiAgICAgICAgICAgIC8vIHBhdXNlIGtleSBwcmVzc2VkXG4gICAgICAgICAgICBwYXVzZSA9ICFwYXVzZTtcbiAgICAgICAgICAgIGlmIChwYXVzZSA9PT0gZmFsc2UpIHtcbiAgICAgICAgICAgICAgICBnLmluaXQoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIGlmIChlLmtleUNvZGUgPT09IDgxKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcInBsYXllciBxdWl0IGdhbWVcIik7XG4gICAgICAgICAgICBhbGVydChcIllvdSBxdWl0LiBHYW1lIE92ZXIhXCIpO1xuICAgICAgICAgICAgZG9jdW1lbnQubG9jYXRpb24ucmVsb2FkKCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBjaGVjayBpZiBhIGtleSB3YXMgcmVsZWFzZWRcbiAgICBrZXlVcEhhbmRsZXIoZSkge1xuICAgICAgICAvLyByZXNldCBrZXkgc3RhdGUgdG8gZGVmYXVsdFxuICAgICAgICBpZiAoZS5rZXlDb2RlID09PSAzOSkge1xuICAgICAgICAgICAgLy8gcmlnaHQgY3Vyc29yIGtleSByZWxlYXNlZFxuICAgICAgICAgICAgZy5yaWdodFByZXNzZWQgPSBmYWxzZTtcbiAgICAgICAgfSBlbHNlIGlmIChlLmtleUNvZGUgPT09IDM3KSB7XG4gICAgICAgICAgICAvLyByaWdodCBjdXJzb3Iga2V5IHJlbGVhc2VkXG4gICAgICAgICAgICBnLmxlZnRQcmVzc2VkID0gZmFsc2U7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBtb3ZlIHBhZGRsZSByZWxhdGl2ZSB0byB0aGUgbW91c2UgcG9zaXRpb24gd2l0aGluIGNhbnZhc1xuICAgIG1vdXNlTW92ZUhhbmRsZXIoZSkge1xuICAgICAgICBsZXQgcmVsYXRpdmVYID0gZS5jbGllbnRYIC0gY2FudmFzLmNhbnZhcy5vZmZzZXRMZWZ0O1xuICAgICAgICBpZiAocmVsYXRpdmVYID4gMCAmJiByZWxhdGl2ZVggPCBjYW52YXMud2lkdGgpIHtcbiAgICAgICAgICAgIHBhZGRsZS5wYWRkbGVYID0gcmVsYXRpdmVYIC0gcGFkZGxlLnBhZGRsZVdpZHRoIC8gMjtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8vIHNldCB0aGUgY3VycmVudCBnYW1lIGluc3RhbmNlJ3MgbW9kZVxuICAgIC8vIHNlbGVjdEdhbWVNb2RlKGUpIHtcbiAgICAvLyAgICAgY29uc3QgeyBuYW1lIH0gPSBlLnRhcmdldDtcbiAgICAvLyAgICAgaWYgKG5hbWUgPT09IFwiZWFzeVwiKSB7XG4gICAgLy8gICAgICAgICB0aGlzLm1vZGUgPSBcImVhc3lcIjtcbiAgICAvLyAgICAgfSBlbHNlIGlmIChuYW1lID09PSBcIm1lZGl1bVwiKSB7XG4gICAgLy8gICAgICAgICB0aGlzLm1vZGUgPSBcIm1lZGl1bVwiO1xuICAgIC8vICAgICB9IGVsc2UgaWYgKG5hbWUgPT09IFwiaGFyZFwiKSB7XG4gICAgLy8gICAgICAgICB0aGlzLm1vZGUgPSBcImhhcmRcIjtcbiAgICAvLyAgICAgfSBlbHNlIHtcbiAgICAvLyAgICAgICAgIHRoaXMubW9kZSA9IFwibWFyYXRob25cIjtcbiAgICAvLyAgICAgfVxuICAgIC8vIH1cbn1cblxuLy8gcGF1c2UgZmxhZ1xubGV0IHBhdXNlID0gdHJ1ZTtcblxuLy8gPCA9PT09PSBTVEFSVElORyBUSEUgR0FNRSA9PT09PSA+XG5cbmxldCBtb2RlID0ge1xuICAgIG5hbWU6IFwidmVyeSBlYXN5XCIsXG4gICAgZHg6IDEuNSxcbiAgICBkeTogLTEuNSxcbiAgICBsaXZlczogNVxufTtcblxuLy8gZ2FtZSBtb2RlIGJ1dHRvbnNcbmNvbnN0IGVhc3lNb2RlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5lYXN5LW1vZGUtYnRuXCIpO1xuY29uc3QgbWVkaXVtTW9kZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubWVkaXVtLW1vZGUtYnRuXCIpO1xuY29uc3QgaGFyZE1vZGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmhhcmQtbW9kZS1idG5cIik7XG5jb25zdCBtYXJhdGhvbk1vZGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLm1hcmF0aG9uLW1vZGUtYnRuXCIpO1xuXG5mdW5jdGlvbiBzZWxlY3RHYW1lTW9kZShlKSB7XG4gICAgY29uc3QgeyBuYW1lIH0gPSBlLnRhcmdldDtcbiAgICBpZiAobmFtZSA9PT0gXCJlYXN5XCIpIHtcbiAgICAgICAgbW9kZSA9IHtcbiAgICAgICAgICAgIG5hbWU6IFwiZWFzeVwiLFxuICAgICAgICAgICAgZHg6IDIsXG4gICAgICAgICAgICBkeTogLTIsXG4gICAgICAgICAgICBsaXZlczogM1xuICAgICAgICB9O1xuICAgICAgICBjb25zb2xlLmxvZyhcIm1vZGUgY2hhbmdlZCB0byBlYXN5XCIsIG1vZGUpO1xuICAgICAgICBiYWxsID0gbmV3IEJhbGwoY2FudmFzLmhlaWdodCwgY2FudmFzLndpZHRoLCBtb2RlKTtcbiAgICAgICAgcGxheWVyID0gbmV3IFBsYXllcihtb2RlKTtcbiAgICAgICAgYnJpY2sgPSBuZXcgQnJpY2soY2FudmFzKTtcbiAgICB9IGVsc2UgaWYgKG5hbWUgPT09IFwibWVkaXVtXCIpIHtcbiAgICAgICAgbW9kZSA9IHtcbiAgICAgICAgICAgIG5hbWU6IFwibWVkaXVtXCIsXG4gICAgICAgICAgICBkeDogMyxcbiAgICAgICAgICAgIGR5OiAtMyxcbiAgICAgICAgICAgIGxpdmVzOiAzXG4gICAgICAgIH07XG4gICAgICAgIGNvbnNvbGUubG9nKFwibW9kZSBjaGFuZ2VkIHRvIG1lZGl1bVwiLCBtb2RlKTtcbiAgICAgICAgYmFsbCA9IG5ldyBCYWxsKGNhbnZhcy5oZWlnaHQsIGNhbnZhcy53aWR0aCwgbW9kZSk7XG4gICAgICAgIHBsYXllciA9IG5ldyBQbGF5ZXIobW9kZSk7XG4gICAgICAgIGJyaWNrID0gbmV3IEJyaWNrKGNhbnZhcyk7XG4gICAgfSBlbHNlIGlmIChuYW1lID09PSBcImhhcmRcIikge1xuICAgICAgICBtb2RlID0ge1xuICAgICAgICAgICAgbmFtZTogXCJoYXJkXCIsXG4gICAgICAgICAgICBkeDogNCxcbiAgICAgICAgICAgIGR5OiAtNCxcbiAgICAgICAgICAgIGxpdmVzOiAyXG4gICAgICAgIH07XG4gICAgICAgIGNvbnNvbGUubG9nKFwibW9kZSBjaGFuZ2VkIHRvIGhhcmRcIiwgbW9kZSk7XG4gICAgICAgIGJhbGwgPSBuZXcgQmFsbChjYW52YXMuaGVpZ2h0LCBjYW52YXMud2lkdGgsIG1vZGUpO1xuICAgICAgICBwbGF5ZXIgPSBuZXcgUGxheWVyKG1vZGUpO1xuICAgICAgICBicmljayA9IG5ldyBCcmljayhjYW52YXMpO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIG1vZGUgPSB7XG4gICAgICAgICAgICBuYW1lOiBcIm1hcmF0aG9uXCIsXG4gICAgICAgICAgICBkeDogNSxcbiAgICAgICAgICAgIGR5OiAtNSxcbiAgICAgICAgICAgIGxpdmVzOiAyXG4gICAgICAgIH07XG4gICAgICAgIGNvbnNvbGUubG9nKFwibW9kZSBjaGFuZ2VkIHRvIG1hcmF0aG9uXCIsIG1vZGUpO1xuICAgICAgICBiYWxsID0gbmV3IEJhbGwoY2FudmFzLmhlaWdodCwgY2FudmFzLndpZHRoLCBtb2RlKTtcbiAgICAgICAgcGxheWVyID0gbmV3IFBsYXllcihtb2RlKTtcbiAgICAgICAgYnJpY2sgPSBuZXcgQnJpY2soY2FudmFzKTtcbiAgICB9XG59XG5cbmNvbnN0IGNhbnZhcyA9IG5ldyBDYW52YXMoKTtcbmxldCBiYWxsID0gbmV3IEJhbGwoY2FudmFzLmhlaWdodCwgY2FudmFzLndpZHRoLCBtb2RlKTtcbmxldCBicmljayA9IG5ldyBCcmljayhjYW52YXMpO1xuY29uc3QgcGFkZGxlID0gbmV3IFBhZGRsZShjYW52YXMpO1xubGV0IHBsYXllciA9IG5ldyBQbGF5ZXIobW9kZSk7XG5jb25zdCBnID0gbmV3IEdhbWUoKTsgLy8gaW5zdGFudGlhdGUgYSBnYW1lXG5cbi8vIHN0b3JlIHlvdXIgb3Bwb25lbnQncyBzY29yZVxuc29ja2V0Lm9uKFwib3RoZXJQbGF5ZXJTY29yZVwiLCBmdW5jdGlvbihkYXRhKSB7XG4gICAgcGxheWVyLm9wcG9uZW50U2NvcmUgPSBkYXRhO1xufSk7XG5cbi8vIHN0b3JlIHlvdXIgb3Bwb25lbnQncyBsaWZlIGNvdW50XG5zb2NrZXQub24oXCJvdGhlclBsYXllckxpZmVcIiwgZnVuY3Rpb24oZGF0YSkge1xuICAgIHBsYXllci5vcHBvbmVudExpdmVzID0gZGF0YTtcbn0pO1xuXG5nLmluaXQoKTsgLy8gc3RhcnQgdGhlIGdhbWUgbG9vcFxuIl0sIm5hbWVzIjpbIkNhbnZhcyIsImNhbnZhcyIsImRvY3VtZW50IiwiZ2V0RWxlbWVudEJ5SWQiLCJjdHgiLCJ0aGlzIiwiZ2V0Q29udGV4dCIsIndpZHRoIiwiaGVpZ2h0IiwiY2xlYXJSZWN0IiwiYmFsbCIsInBhZGRsZSIsInBsYXllciIsInkiLCJkeSIsImJhbGxSYWRpdXMiLCJjaGFuZ2VDb2xvciIsIngiLCJwYWRkbGVYIiwicGFkZGxlV2lkdGgiLCJsaXZlcyIsImxvY2F0aW9uIiwicmVsb2FkIiwiZHgiLCJicmljayIsImNvbCIsImJyaWNrQ29sdW1uQ291bnQiLCJyb3ciLCJicmlja1Jvd0NvdW50IiwiYiIsImJyaWNrcyIsInN0YXR1cyIsImJyaWNrV2lkdGgiLCJicmlja0hlaWdodCIsInNjb3JlIiwiQmFsbCIsIm1vZGUiLCJiYWxsQ29sb3IiLCJjb2xvciIsIk1hdGgiLCJyYW5kb20iLCJiZWdpblBhdGgiLCJhcmMiLCJQSSIsImZpbGxTdHlsZSIsImZpbGwiLCJjbG9zZVBhdGgiLCJCcmljayIsImJyaWNrQ29sb3IiLCJicmlja1BhZGRpbmciLCJicmlja09mZnNldFRvcCIsImJyaWNrT2Zmc2V0TGVmdCIsImJyaWNrWCIsImJyaWNrWSIsInJlY3QiLCJQYWRkbGUiLCJwYWRkbGVDb2xvciIsInBhZGRsZUhlaWdodCIsIlBsYXllciIsIm9wcG9uZW50U2NvcmUiLCJvcHBvbmVudExpdmVzIiwiZm9udCIsImZpbGxUZXh0IiwidXNlcm5hbWUiLCJzb2NrZXQiLCJpbyIsImNvbm5lY3QiLCJ3cml0ZSIsImhvc3QiLCJzcGxpdCIsIkdhbWUiLCJyaWdodFByZXNzZWQiLCJsZWZ0UHJlc3NlZCIsInBsYXllcnMiLCJhZGRFdmVudExpc3RlbmVyIiwia2V5RG93bkhhbmRsZXIiLCJrZXlVcEhhbmRsZXIiLCJtb3VzZU1vdmVIYW5kbGVyIiwic2VsZWN0R2FtZU1vZGUiLCJfdGhpcyIsImRyYXciLCJsb2ciLCJuYW1lIiwiY2xlYXIiLCJkcmF3UGFkZGxlIiwiZHJhd0JyaWNrcyIsImRyYXdCYWxsIiwiZHJhd1Njb3JlIiwiZHJhd0xpdmVzIiwiZGV0ZWN0QnJpY2tDb2xsaXNpb25zIiwiZGV0ZWN0RWRnZUNvbGxpc2lvbnMiLCJlbWl0IiwidXBkYXRlIiwicGF1c2UiLCJlIiwia2V5Q29kZSIsImluaXQiLCJyZWxhdGl2ZVgiLCJjbGllbnRYIiwib2Zmc2V0TGVmdCIsImVhc3lNb2RlIiwicXVlcnlTZWxlY3RvciIsIm1lZGl1bU1vZGUiLCJoYXJkTW9kZSIsIm1hcmF0aG9uTW9kZSIsInRhcmdldCIsImciLCJvbiIsImRhdGEiXSwibWFwcGluZ3MiOiJpWEFBTUEseUNBRU9DLE9BQVNDLFNBQVNDLGVBQWUsaUJBQ2pDQyxJQUFNQyxLQUFLSixPQUFPSyxXQUFXLFdBQzdCQyxNQUFRRixLQUFLSixPQUFPTSxXQUNwQkMsT0FBU0gsS0FBS0osT0FBT08sc0RBSXJCSixJQUFJSyxVQUFVLEVBQUcsRUFBR0osS0FBS0UsTUFBT0YsS0FBS0cscURBSXpCRSxFQUFNQyxFQUFRQyxHQUUzQkYsRUFBS0csRUFBSUgsRUFBS0ksR0FBS0osRUFBS0ssY0FDbkJELElBQU1KLEVBQUtJLEtBQ1hFLGVBQ0VOLEVBQUtHLEVBQUlILEVBQUtJLEdBQUtULEtBQUtHLE9BQVNFLEVBQUtLLGFBRXpDTCxFQUFLTyxFQUFJTixFQUFPTyxTQUNoQlIsRUFBS08sRUFBSU4sRUFBT08sUUFBVVAsRUFBT1EsZUFHNUJMLElBQU1KLEVBQUtJLEtBQ1hFLGtCQUVFSSxRQUNjLElBQWpCUixFQUFPUSxhQUNELHNCQUNHQyxTQUFTQyxhQUViTCxFQUFJWixLQUFLRSxNQUFRLElBQ2pCTSxFQUFJUixLQUFLRyxPQUFTLEtBQ2hCVSxTQUFXYixLQUFLRSxNQUFRSSxFQUFPUSxhQUFlLE1BTTdEVCxFQUFLTyxFQUFJUCxFQUFLYSxHQUFLYixFQUFLSyxZQUN4QkwsRUFBS08sRUFBSVAsRUFBS2EsR0FBS2xCLEtBQUtFLE1BQVFHLEVBQUtLLGdCQUVoQ1EsSUFBTWIsRUFBS2EsS0FDWFAsNkRBSVNOLEVBQU1jLEVBQU9aLE9BRTFCLElBQUlhLEVBQU0sRUFBR0EsRUFBTUQsRUFBTUUsaUJBQWtCRCxRQUN2QyxJQUFJRSxFQUFNLEVBQUdBLEVBQU1ILEVBQU1JLGNBQWVELElBQU8sS0FDNUNFLEVBQUlMLEVBQU1NLE9BQU9MLEdBQUtFLEdBRVQsSUFBYkUsRUFBRUUsUUFJRXJCLEVBQUtPLEVBQUlZLEVBQUVaLEtBQ05BLEVBQUlZLEVBQUVaLEVBQUlPLEVBQU1RLGNBQ2hCbkIsRUFBSWdCLEVBQUVoQixLQUNOQSxFQUFJZ0IsRUFBRWhCLEVBQUlXLEVBQU1TLGdCQUVoQm5CLElBQU1KLEVBQUtJLEtBQ1hFLGdCQUNIZSxPQUFTLElBQ0pHLFFBRUh0QixFQUFPc0IsT0FDUFYsRUFBTUksY0FBZ0JKLEVBQU1FLHlCQUd0QiwrQkFDR0wsU0FBU0MscUJDekV4Q2Esd0JBQ1UzQixFQUFRRCxFQUFPNkIsa0JBQ2xCQyxVQUFZLGVBRVpwQixFQUFJVixFQUFRLE9BQ1pNLEVBQUlMLEVBQVMsUUFDYk8sV0FBYSxRQUViUSxHQUFLYSxFQUFLYixRQUNWVCxHQUFLc0IsRUFBS3RCLHVEQU9Ud0IsU0FIc0IsSUFBaEJDLEtBQUtDLGNBQ2EsSUFBaEJELEtBQUtDLGNBQ1UsSUFBaEJELEtBQUtDLGtCQUViSCxVQUFZQyxtQ0FJWnJDLEtBQ0VHLElBQUlxQyxjQUNKckMsSUFBSXNDLElBQUlyQyxLQUFLWSxFQUFHWixLQUFLUSxFQUFHUixLQUFLVSxXQUFZLEVBQWEsRUFBVndCLEtBQUtJLE1BQ2pEdkMsSUFBSXdDLFVBQVl2QyxLQUFLZ0MsWUFDckJqQyxJQUFJeUMsU0FDSnpDLElBQUkwQyxrREFLTjdCLEdBQUtaLEtBQUtrQixRQUNWVixHQUFLUixLQUFLUyxZQ2hDakJpQyx5Q0FHQ0MsV0FBYSxlQUNicEIsY0FBZ0IsUUFDaEJGLGlCQUFtQixPQUNuQk0sV0FBYSxRQUNiQyxZQUFjLFFBQ2RnQixhQUFlLFFBQ2ZDLGVBQWlCLFFBQ2pCQyxnQkFBa0IsU0FFbEJyQixPQUFTLE9BRVQsSUFBSUwsRUFBTSxFQUFHQSxFQUFNcEIsS0FBS3FCLGlCQUFrQkQsSUFBTyxNQUNoREssT0FBT0wsR0FBTyxPQUNkLElBQUlFLEVBQU0sRUFBR0EsRUFBTXRCLEtBQUt1QixjQUFlRCxTQUN0Q0csT0FBT0wsR0FBS0UsR0FBTyxDQUFFVixFQUFHLEVBQUdKLEVBQUcsRUFBR2tCLE9BQVEsaURBTXRDOUIsT0FDTCxJQUFJd0IsRUFBTSxFQUFHQSxFQUFNcEIsS0FBS3FCLGlCQUFrQkQsUUFDekMsSUFBSUUsRUFBTSxFQUFHQSxFQUFNdEIsS0FBS3VCLGNBQWVELElBQU8sS0FDOUNILEVBQVFuQixLQUFLeUIsT0FBT0wsR0FBS0UsTUFDUixJQUFqQkgsRUFBTU8sT0FBYyxLQUVuQnFCLEVBQ0gzQixHQUFPcEIsS0FBSzJCLFdBQWEzQixLQUFLNEMsY0FBZ0I1QyxLQUFLOEMsZ0JBQ2hERSxFQUNIMUIsR0FBT3RCLEtBQUs0QixZQUFjNUIsS0FBSzRDLGNBQWdCNUMsS0FBSzZDLGlCQUMvQ2pDLEVBQUltQyxJQUNKdkMsRUFBSXdDLElBQ0hqRCxJQUFJcUMsY0FDSnJDLElBQUlrRCxLQUFLOUIsRUFBTVAsRUFBR08sRUFBTVgsRUFBR1IsS0FBSzJCLFdBQVkzQixLQUFLNEIsZUFDakQ3QixJQUFJd0MsVUFBWXZDLEtBQUsyQyxhQUNyQjVDLElBQUl5QyxTQUNKekMsSUFBSTBDLHVCQ3ZDVlMsd0JBQ090RCxrQkFFTnVELFlBQWMsZUFDZEMsYUFBZSxRQUNmdEMsWUFBYyxRQUVkRCxTQUFXakIsRUFBT00sTUFBUUYsS0FBS2MsYUFBZSwrQ0FJekNsQixLQUNIRyxJQUFJcUMsY0FDSnJDLElBQUlrRCxLQUNWakQsS0FBS2EsUUFDTGpCLEVBQU9PLE9BQVNILEtBQUtvRCxhQUNyQnBELEtBQUtjLFlBQ0xkLEtBQUtvRCxnQkFFQ3JELElBQUl3QyxVQUFZdkMsS0FBS21ELGNBQ3JCcEQsSUFBSXlDLFNBQ0p6QyxJQUFJMEMsMkNBSUw3QixRQUNEQyxTQUFXRCxXQzFCWnlDLHdCQUNVdEIsa0JBQ0hoQixNQUFRZ0IsRUFBS2hCLFdBQ2JjLE1BQVEsT0FDUnlCLGNBQWdCLE9BQ2hCQyxjQUFnQixPQUNoQjNDLEVBQUksT0FDSkosRUFBSSw4Q0FJSFosS0FDQ0csSUFBSXlELEtBQU8sZUFDWHpELElBQUl3QyxVQUFZLFlBQ2hCeEMsSUFBSTBELFNBQVMsVUFBWXpELEtBQUs2QixNQUFPLEVBQUcsTUFDeEM5QixJQUFJMEQsU0FBUyxxQkFBdUJ6RCxLQUFLc0QsY0FBZSxFQUFHLHNDQUk1RDFELEtBQ0NHLElBQUl5RCxLQUFPLGVBQ1h6RCxJQUFJd0MsVUFBWSxZQUNoQnhDLElBQUkwRCxTQUFTLFVBQVl6RCxLQUFLZSxNQUFPbkIsRUFBT00sTUFBUSxHQUFJLE1BQ3hESCxJQUFJMEQsU0FDUCxxQkFBdUJ6RCxLQUFLdUQsY0FDNUIzRCxFQUFPTSxNQUFRLElBQ2YsbUNBS0RhLEVBQU8yQyxFQUFVN0IsUUFDZmQsT0FBU0EsT0FDVDJDLFNBQVdBLE9BQ1g3QixPQUFTQSxXQ2xDaEI4QixFQUFTQyxHQUFHQyxRQUFRLHFDQ1MxQmhFLFNBQVNpRSxNQUNMLHlCQUNLOUMsU0FBUytDLE1BQVEsYUFBYUMsTUFBTSxLQUFLLEdBQzFDLGtEQUlGQyx5Q0FFT0MsY0FBZSxPQUNmQyxhQUFjLE9BQ2RDLFFBQVUsVUFHUkMsaUJBQWlCLFVBQVdyRSxLQUFLc0UsZ0JBQWdCLFVBQ2pERCxpQkFBaUIsUUFBU3JFLEtBQUt1RSxjQUFjLFVBRTdDRixpQkFBaUIsWUFBYXJFLEtBQUt3RSxrQkFBa0IsS0FFbkRILGlCQUFpQixRQUFTSSxHQUFnQixLQUN4Q0osaUJBQWlCLFFBQVNJLEdBQWdCLEtBQzVDSixpQkFBaUIsUUFBU0ksR0FBZ0IsS0FDdENKLGlCQUFpQixRQUFTSSxHQUFnQiw2RUFLakMsa0JBQU1DLEVBQUtDLEtBQUsvRSxrQ0FJckNBLHNCQUNPZ0YsWUFBWTdDLEVBQUs4QyxRQUVsQkMsVUFDQS9FLElBQUlxQyxjQUNKMkMsV0FBV25GLEtBQ1pvRixXQUFXcEYsS0FDWnFGLFNBQVNyRixLQUNQc0YsVUFBVXRGLEtBQ1Z1RixVQUFVdkYsS0FDVndGLHNCQUFzQi9FLEVBQU1jLEVBQU9aLEtBQ25DOEUscUJBQXFCaEYsRUFBTUMsRUFBUUMsS0FFbkMrRSxLQUFLLGVBQWdCL0UsS0FDckIrRSxLQUFLLGFBQWMvRSxHQUl0QlAsS0FBS2tFLGNBQ0w1RCxFQUFPTyxRQUFVakIsRUFBT00sTUFBUUksRUFBT1EsY0FFaEN5RSxPQUFPLEdBQ1B2RixLQUFLbUUsYUFBZ0MsRUFBakI3RCxFQUFPTyxXQUMzQjBFLFFBQVEsS0FHZEEsVUFFUyxJQUFWQyx5QkFFc0IsYUFDYmIsS0FBSy9FLDRDQU1QNkYsR0FDTyxLQUFkQSxFQUFFQyxVQUVBeEIsY0FBZSxFQUNJLEtBQWR1QixFQUFFQyxVQUVQdkIsYUFBYyxFQUNLLEtBQWRzQixFQUFFQyxTQUdLLFFBRExGLE1BRUhHLE9BRWUsS0FBZEYsRUFBRUMsa0JBQ0RkLElBQUksMEJBQ04saUNBQ0c1RCxTQUFTQywrQ0FLYndFLEdBRVMsS0FBZEEsRUFBRUMsVUFFQXhCLGNBQWUsRUFDSSxLQUFkdUIsRUFBRUMsWUFFUHZCLGFBQWMsNENBS1BzQixPQUNURyxFQUFZSCxFQUFFSSxRQUFVakcsRUFBT0EsT0FBT2tHLFdBQzFCLEVBQVpGLEdBQWlCQSxFQUFZaEcsRUFBT00sVUFDN0JXLFFBQVUrRSxFQUFZdEYsRUFBT1EsWUFBYyxZQW9CMUQwRSxHQUFRLEVBSVJ6RCxFQUFPLE1BQ0QsZUFDRixRQUNDLFVBQ0UsR0FJTGdFLEVBQVdsRyxTQUFTbUcsY0FBYyxrQkFDbENDLEVBQWFwRyxTQUFTbUcsY0FBYyxvQkFDcENFLEVBQVdyRyxTQUFTbUcsY0FBYyxrQkFDbENHLEVBQWV0RyxTQUFTbUcsY0FBYyxzQkFFNUMsU0FBU3ZCLEVBQWVnQixPQUNaWixFQUFTWSxFQUFFVyxPQUFYdkIsS0FDSyxTQUFUQSxLQUNPLE1BQ0csVUFDRixNQUNDLFFBQ0UsV0FFSEQsSUFBSSx1QkFBd0I3QyxJQUlwQixXQUFUOEMsS0FDQSxNQUNHLFlBQ0YsTUFDQyxRQUNFLFdBRUhELElBQUkseUJBQTBCN0MsSUFJdEIsU0FBVDhDLEtBQ0EsTUFDRyxVQUNGLE1BQ0MsUUFDRSxXQUVIRCxJQUFJLHVCQUF3QjdDLE9BSzdCLE1BQ0csY0FDRixNQUNDLFFBQ0UsV0FFSDZDLElBQUksMkJBQTRCN0MsTUFoQ2pDLElBQUlELEVBQUtsQyxFQUFPTyxPQUFRUCxFQUFPTSxNQUFPNkIsS0FDcEMsSUFBSXNCLEVBQU90QixLQUNaLElBQUlXLEVBQU05QyxHQXFDMUIsSUFBTUEsRUFBUyxJQUFJRCxFQUNmVSxFQUFPLElBQUl5QixFQUFLbEMsRUFBT08sT0FBUVAsRUFBT00sTUFBTzZCLEdBQzdDWixFQUFRLElBQUl1QixFQUFNOUMsR0FDaEJVLEVBQVMsSUFBSTRDLEVBQU90RCxHQUN0QlcsRUFBUyxJQUFJOEMsRUFBT3RCLEdBQ2xCc0UsRUFBSSxJQUFJcEMsRUFHZE4sRUFBTzJDLEdBQUcsbUJBQW9CLFNBQVNDLEtBQzVCakQsY0FBZ0JpRCxJQUkzQjVDLEVBQU8yQyxHQUFHLGtCQUFtQixTQUFTQyxLQUMzQmhELGNBQWdCZ0QsSUFHM0JGLEVBQUVWIn0=
